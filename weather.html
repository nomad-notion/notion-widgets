<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion Weather Widget</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì„¤ì • */
        :root {
            --bg-color: #ffffff;
            --text-color: #37352f;
            --sub-text-color: #787774;
            --card-bg: #f7f6f3;
        }

        /* ë‹¤í¬ëª¨ë“œ ê°ì§€ ë° ìŠ¤íƒ€ì¼ */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #191919;
                --text-color: #d4d4d4;
                --sub-text-color: #9b9a97;
                --card-bg: #2f2f2f;
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .widget-container {
            width: 100%;
            height: 100%;
            max-width: 400px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .weather-icon {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: float 3s ease-in-out infinite;
        }

        .temperature {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .location {
            font-size: 0.9rem;
            color: var(--sub-text-color);
            margin-bottom: 20px;
        }

        .recommendation {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            width: 100%;
        }

        .outfit {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .comment {
            font-size: 0.9rem;
            color: var(--sub-text-color);
            line-height: 1.4;
        }

        /* ë‘¥ë‘¥ ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
    </style>
</head>
<body>

    <div class="widget-container" id="widget">
        <div class="weather-icon" id="icon">â³</div>
        <div class="temperature" id="temp">ë¡œë”©ì¤‘...</div>
        <div class="location" id="loc">ìœ„ì¹˜ í™•ì¸ ì¤‘</div>
        
        <div class="recommendation">
            <div class="outfit" id="outfit">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</div>
            <div class="comment" id="comment">ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</div>
        </div>
    </div>

    <script>
        // ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(fetchWeather, showError);
            } else {
                displayData(20, 0, "ìœ„ì¹˜ ê¶Œí•œ ì—†ìŒ"); // ê¸°ë³¸ê°’
            }
        }

        // ë‚ ì”¨ API í˜¸ì¶œ (Open-Meteo ì‚¬ìš© - ë¬´ë£Œ, í‚¤ ë¶ˆí•„ìš”)
        async function fetchWeather(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                const data = await response.json();
                
                const temp = data.current_weather.temperature;
                const weatherCode = data.current_weather.weathercode;
                
                displayData(temp, weatherCode);
            } catch (error) {
                document.getElementById('temp').innerText = "Error";
            }
        }

        function showError(error) {
            // ìœ„ì¹˜ ê¶Œí•œ ê±°ë¶€ ì‹œ ì„œìš¸ ê¸°ì¤€ ê¸°ë³¸ê°’ í‘œì‹œ (ì˜ˆì‹œ)
            displayData(20, 1, "ìœ„ì¹˜ ê¶Œí•œ í•„ìš”");
        }

        // ë°ì´í„° í™”ë©´ í‘œì‹œ ë¡œì§
        function displayData(temp, code, locText = "í˜„ì¬ ìœ„ì¹˜") {
            const iconEl = document.getElementById('icon');
            const tempEl = document.getElementById('temp');
            const outfitEl = document.getElementById('outfit');
            const commentEl = document.getElementById('comment');
            const locEl = document.getElementById('loc');

            tempEl.innerText = `${Math.round(temp)}Â°C`;
            locEl.innerText = locText;

            // 1. ë‚ ì”¨ ì½”ë“œì— ë”°ë¥¸ ì•„ì´ì½˜ ì„¤ì •
            // WMO Weather interpretation codes (WW)
            let isRaining = false;
            if (code <= 1) iconEl.innerText = "â˜€ï¸"; // ë§‘ìŒ
            else if (code <= 3) iconEl.innerText = "â›…"; // êµ¬ë¦„ ì¡°ê¸ˆ
            else if (code <= 48) iconEl.innerText = "â˜ï¸"; // íë¦¼/ì•ˆê°œ
            else if (code <= 67) { iconEl.innerText = "â˜”"; isRaining = true; } // ë¹„
            else if (code <= 77) { iconEl.innerText = "â„ï¸"; isRaining = true; } // ëˆˆ
            else if (code <= 99) { iconEl.innerText = "â›ˆï¸"; isRaining = true; } // ë‡Œìš°
            else iconEl.innerText = "ğŸŒ¡ï¸";

            // 2. ê¸°ì˜¨ & ë‚ ì”¨ì— ë”°ë¥¸ ë©˜íŠ¸ ë° ì˜·ì°¨ë¦¼ ì¶”ì²œ ë¡œì§
            let outfit = "";
            let comment = "";

            if (isRaining) {
                outfit = "ìš°ì‚°, ë ˆì¸ë¶€ì¸ , ê²‰ì˜·";
                comment = "ë¹„ë‚˜ ëˆˆì´ ì™€ìš”. ì –ì§€ ì•Šê²Œ ì¡°ì‹¬í•˜ì„¸ìš”! ë”°ëœ»í•œ ì°¨ í•œ ì” ì–´ë•Œìš”? â˜•";
            } else {
                if (temp >= 28) {
                    outfit = "ë¯¼ì†Œë§¤, ë°˜ë°”ì§€, ë¦°ë„¨ ì†Œì¬";
                    comment = "ì •ë§ ë”ìš´ ë‚ ì”¨ë„¤ìš”! ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ìˆ˜í˜ˆì´ ì‹œê¸‰í•´ìš” ğŸ§Š";
                    iconEl.innerText = "ğŸ¥µ";
                } else if (temp >= 23) {
                    outfit = "ë°˜íŒ”, ì–‡ì€ ì…”ì¸ , ë©´ë°”ì§€";
                    comment = "ì´ˆì—¬ë¦„ ë‚ ì”¨ì˜ˆìš”. ê°€ë³ê²Œ ì…ê³  ì‚°ì±…í•˜ê¸° ë”± ì¢‹ì€ ë‚ ! ğŸŒ¿";
                } else if (temp >= 20) {
                    outfit = "ì–‡ì€ ê°€ë””ê±´, ê¸´íŒ” í‹°ì…”ì¸ ";
                    comment = "í™œë™í•˜ê¸° ê°€ì¥ ì¢‹ì€ ì˜¨í™”í•œ ë‚ ì”¨ì˜ˆìš”. ğŸ˜Š";
                } else if (temp >= 17) {
                    outfit = "ë§¨íˆ¬ë§¨, í›„ë“œí‹°, ì–‡ì€ ì¬í‚·";
                    comment = "ì¼êµì°¨ê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. ì–‡ì€ ê²‰ì˜·ì„ ì±™ê¸°ë©´ ì„¼ìŠ¤ìŸì´! ğŸ˜‰";
                } else if (temp >= 12) {
                    outfit = "ìì¼“, ì•¼ìƒ, ë‹ˆíŠ¸, ìŠ¤íƒ€í‚¹";
                    comment = "ìŒ€ìŒ€í•˜ë„¤ìš”. ê°ê¸° ê±¸ë¦¬ì§€ ì•Šê²Œ ëª©ì„ ë”°ëœ»í•˜ê²Œ í•´ì£¼ì„¸ìš”. ğŸ§£";
                } else if (temp >= 5) {
                    outfit = "ì½”íŠ¸, ê°€ì£½ì¬í‚·, ë„í†°í•œ ë‹ˆíŠ¸";
                    comment = "ê³µê¸°ê°€ ì°¨ê°€ì›Œìš”. ì½”íŠ¸ ê¹ƒì„ ì„¸ìš°ê³  ë¶„ìœ„ê¸° ìˆê²Œ ê±¸ì–´ë³¼ê¹Œìš”? ğŸ‚";
                } else {
                    outfit = "íŒ¨ë”©, ë‘êº¼ìš´ ì½”íŠ¸, ëª©ë„ë¦¬, ì¥ê°‘";
                    comment = "ë„ˆë¬´ ì¶”ì›Œìš”! ì´ë¶ˆ ë°–ì€ ìœ„í—˜í•´.. í•«íŒ© ê¼­ ì±™ê¸°ì„¸ìš”! ğŸ”¥";
                    iconEl.innerText = "ğŸ¥¶";
                }
            }

            outfitEl.innerText = `ì¶”ì²œ ë£©: ${outfit}`;
            commentEl.innerText = comment;
        }

        // ì‹¤í–‰
        getLocation();
    </script>
</body>
</html>
