<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome Goal Widget</title>
  <style>
    /* 1. 폰트 및 기본 설정 */
    body {
      margin: 0; padding: 0;
      width: 100%; height: 100vh;
      background-color: transparent;
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
      display: flex; justify-content: center; align-items: center;
      overflow: hidden;
      color: #37352F;
    }

    /* 2. 메인 컨테이너 (좌우 배치 Flex) */
    .container {
      width: 90%; 
      max-width: 650px; /* 전체 폭을 줄임 (컴팩트하게) */
      height: auto;
      min-height: 200px; /* 최소 높이 확보 */
      background-color: #F7F6F3; /* 노션 회색 배경 */
      border: 1px solid rgba(55, 53, 47, 0.09);
      border-radius: 12px;
      display: flex; /* 좌우 배치 핵심 */
      box-shadow: 0 2px 8px rgba(0,0,0,0.02);
      overflow: hidden; /* 이미지가 둥근 모서리를 넘지 않게 */
      position: relative;
    }

    /* 3. [왼쪽] 이미지 영역 (20%) */
    .image-section {
      flex: 0 0 25%; /* 너비 25% 정도로 설정 (20%는 너무 좁을 수 있어서) */
      background-color: #EBEAE8; /* 이미지 배경색 (선택사항) */
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .char-img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* 영역에 꽉 차게 */
      /* 만약 이미지가 잘리는 게 싫으면 'contain'으로 바꾸세요 */
    }

    /* 4. [오른쪽] 콘텐츠 영역 (나머지) */
    .content-section {
      flex: 1;
      padding: 25px 30px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start; /* 왼쪽 정렬 */
      position: relative;
    }

    /* 5. 헤더 (Welcome + 날짜) */
    .header-title {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: #37352F;
    }
    
    .header-date {
      font-size: 0.9rem;
      color: rgba(55, 53, 47, 0.6);
      font-weight: 500;
      margin-bottom: 25px; /* 목표 입력창과의 간격 */
    }

    /* 6. 목표(One Pick) 영역 */
    .goal-wrapper {
      width: 100%;
    }

    /* 입력 모드 */
    #input-section {
      display: flex; flex-direction: column; align-items: flex-start;
      width: 100%;
    }
    
    input[type="text"] {
      background: transparent; border: none;
      border-bottom: 2px solid rgba(55, 53, 47, 0.2);
      width: 95%; font-family: inherit;
      font-size: 1.1rem; color: #37352F;
      padding: 8px 0;
      outline: none;
      transition: border-color 0.3s;
    }
    input[type="text"]:focus {
      border-bottom: 2px solid #37352F; /* 포커스 시 진하게 */
    }
    input::placeholder { color: rgba(55, 53, 47, 0.3); font-size: 1rem; }
    .hint { font-size: 0.75rem; color: rgba(55, 53, 47, 0.4); margin-top: 6px; }

    /* 전시 모드 */
    #display-section {
      display: none; flex-direction: column;
      align-items: flex-start; justify-content: center;
    }
    .mission-label {
      font-size: 0.75rem; color: rgba(55, 53, 47, 0.5);
      margin-bottom: 4px; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.05em;
    }
    .mission-text {
      font-size: 1.5rem; font-weight: 700;
      line-height: 1.3; margin-bottom: 12px;
      word-break: keep-all; color: #37352F;
    }
    .finish-btn {
      background-color: transparent; 
      border: 1px solid rgba(55, 53, 47, 0.2);
      color: #37352F; padding: 5px 12px;
      border-radius: 4px; cursor: pointer;
      font-family: inherit; font-size: 0.8rem;
      transition: all 0.2s ease;
    }
    .finish-btn:hover { background-color: rgba(55, 53, 47, 0.05); }

    /* 7. 서명 & 팝업 */
    .signature {
      position: absolute; bottom: 8px; right: 15px;
      font-size: 0.6rem; color: rgba(55, 53, 47, 0.2);
    }

    #custom-modal {
      display: none; position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background-color: rgba(255, 255, 255, 0.96);
      justify-content: center; align-items: center; 
      flex-direction: column; z-index: 999;
      border-radius: 12px;
    }
    .modal-msg { font-size: 1rem; margin-bottom: 15px; font-weight: 600; color: #37352F; }
    .modal-btn-group { display: flex; gap: 8px; }
    .modal-btn {
      padding: 6px 16px; border-radius: 4px; cursor: pointer;
      font-family: inherit; font-size: 0.9rem; border: 1px solid rgba(55, 53, 47, 0.16);
    }
    .btn-yes { background-color: #37352F; color: white; border: 1px solid #37352F; }
    .btn-no { background-color: transparent; }

    /* 모바일 대응 (화면 좁을 때) */
    @media (max-width: 500px) {
      .container { flex-direction: column; max-width: 90%; }
      .image-section { width: 100%; height: 120px; flex: none; }
      .content-section { padding: 20px; }
    }
  </style>
</head>
<body>

  <div class="container">
    
    <div class="image-section">
      <img src="./stamp.png" class="char-img" alt="Character">
    </div>

    <div class="content-section">
      
      <div class="header-title">Welcome to Your Workspace</div>
      <div class="header-date" id="clock">Loading...</div>

      <div class="goal-wrapper">
        <div id="input-section">
          <input type="text" id="goalInput" placeholder="오늘의 가장 중요한 목표는?" autocomplete="off" onkeypress="handleEnter(event)">
          <div class="hint">입력 후 Enter</div>
        </div>
        <div id="display-section">
          <div class="mission-label">TODAY'S FOCUS</div>
          <div class="mission-text" id="goalDisplay"></div>
          <button class="finish-btn" onclick="openModal()">완료 (Reset)</button>
        </div>
      </div>

      <div class="signature">nomadplanner</div>
    </div>

    <div id="custom-modal">
      <div class="modal-msg">목표를 완료하고 초기화할까요?</div>
      <div class="modal-btn-group">
        <button class="modal-btn btn-yes" onclick="confirmReset()">네</button>
        <button class="modal-btn btn-no" onclick="closeModal()">아니오</button>
      </div>
    </div>

  </div>

  <script>
    /* 안전 저장소 로직 */
    let memoryStorage = "";
    function saveGoalSafe(val) { try { localStorage.setItem('myOneFocus', val); } catch(e) { memoryStorage = val; } }
    function getGoalSafe() { try { return localStorage.getItem('myOneFocus'); } catch(e) { return memoryStorage; } }
    function removeGoalSafe() { try { localStorage.removeItem('myOneFocus'); } catch(e) { memoryStorage = ""; } }

    /* 시계 업데이트 (날짜/시간) */
    function updateClock() {
      const clockEl = document.getElementById('clock');
      if(!clockEl) return;
      
      const now = new Date();
      // 날짜 포맷: 1월 1일 (목)
      const month = now.getMonth() + 1;
      const date = now.getDate();
      const dayList = ['일', '월', '화', '수', '목', '금', '토'];
      const day = dayList[now.getDay()];
      
      // 시간 포맷: 오전 9:41
      let hours = now.getHours();
      let minutes = now.getMinutes();
      const ampm = hours >= 12 ? '오후' : '오전';
      hours = hours % 12; hours = hours ? hours : 12; 
      minutes = minutes < 10 ? '0' + minutes : minutes; 

      clockEl.innerText = `${month}월 ${date}일 (${day}), ${ampm} ${hours}:${minutes}`;
    }

    /* 목표 기능 로직 */
    function showInputMode() {
      document.getElementById('input-section').style.display = 'flex';
      document.getElementById('display-section').style.display = 'none';
      const input = document.getElementById('goalInput');
      if(input) { input.value = ""; input.focus(); }
    }

    function showDisplayMode(text) {
      document.getElementById('input-section').style.display = 'none';
      document.getElementById('display-section').style.display = 'flex';
      document.getElementById('goalDisplay').innerText = text;
    }

    function handleEnter(e) {
      if (e.key === 'Enter') {
        const val = e.target.value;
        if(val.trim() !== "") {
          saveGoalSafe(val);
          showDisplayMode(val);
        }
      }
    }

    /* 팝업 로직 */
    function openModal() { document.getElementById('custom-modal').style.display = 'flex'; }
    function closeModal() { document.getElementById('custom-modal').style.display = 'none'; }
    function confirmReset() {
      removeGoalSafe();
      closeModal();
      showInputMode();
    }

    /* 초기화 */
    (function init() {
      updateClock();
      setInterval(updateClock, 1000);

      const saved = getGoalSafe();
      if(saved) showDisplayMode(saved);
      else showInputMode();
    })();
  </script>
</body>
</html>
