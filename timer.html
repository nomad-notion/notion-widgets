<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timer Pie Final</title>
  <style>
    /* 1. ë ˆì´ì•„ì›ƒ (ë¬´ì¡°ê±´ í™”ë©´ ì¤‘ì•™ ì •ë ¬) */
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100vh;
      background-color: transparent;
      font-family: ui-sans-serif, -apple-system, sans-serif;
      display: flex; justify-content: center; align-items: center;
      overflow: hidden;
      color: #37352F;
    }

    /* 2. ì»¨í…Œì´ë„ˆ (ë¬´ì¡°ê±´ ë³´ì„ ì„¤ì •) */
    .container {
      width: 90%; max-width: 320px;
      background-color: #F7F6F3;
      border: 1px solid rgba(55, 53, 47, 0.09);
      border-radius: 16px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      text-align: center;
      padding: 24px; box-sizing: border-box;
      box-shadow: 0 2px 10px rgba(0,0,0,0.03);
      position: relative;
      
      /* â˜… í•µì‹¬: JS ì—ëŸ¬ê°€ ë‚˜ë„ í™”ë©´ì€ ëœ¨ê²Œ ê°•ì œí•¨ â˜… */
      visibility: visible !important; opacity: 1 !important; 
      min-height: 280px;
    }

    /* === ì„ íƒ í™”ë©´ (ê¸°ë³¸ê°’: ë³´ì„) === */
    #selection-screen {
      display: flex; /* CSSê°€ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§ */
      flex-direction: column; width: 100%; gap: 12px;
    }

    .menu-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 10px; }
    .select-btn {
      padding: 14px; border-radius: 10px;
      border: 1px solid rgba(55, 53, 47, 0.1);
      background-color: white; color: #37352F;
      font-size: 1rem; font-weight: 600; cursor: pointer;
      display: flex; align-items: center; justify-content: center; gap: 8px;
      transition: 0.2s;
    }
    .select-btn:hover { background-color: rgba(55, 53, 47, 0.04); transform: scale(1.02); }

    /* === íƒ€ì´ë¨¸ í™”ë©´ (ê¸°ë³¸ê°’: ìˆ¨ê¹€) === */
    #timer-screen {
      display: none; /* JSë¡œ í™œì„±í™” */
      flex-direction: column; align-items: center; width: 100%;
    }

    .timer-header {
      width: 100%; display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 20px;
    }
    .back-btn {
      background: none; border: none; cursor: pointer;
      font-size: 0.85rem; color: rgba(55, 53, 47, 0.4); padding: 0;
    }
    .back-btn:hover { color: #37352F; }
    .mode-badge {
      font-size: 0.7rem; font-weight: 800;
      padding: 4px 8px; border-radius: 6px;
      text-transform: uppercase; letter-spacing: 0.05em;
    }

    .timer-display {
      font-size: 3.2rem; font-weight: 800;
      font-variant-numeric: tabular-nums; line-height: 1;
      margin-bottom: 15px;
    }

    /* â˜… íŒŒì´ ì°¨íŠ¸ (Pie Chart) ë””ìì¸ â˜… */
    .gauge-box {
      position: relative; width: 60px; height: 60px;
      margin-bottom: 25px; display: flex; justify-content: center; align-items: center;
    }
    .progress-ring { transform: rotate(-90deg); width: 100%; height: 100%; }
    
    /* ë°°ê²½ ì› (ì—°í•œ ìƒ‰) */
    .bg-ring { 
      fill: none; 
      stroke: rgba(55, 53, 47, 0.08); 
      stroke-width: 32; /* ë°˜ì§€ë¦„(16)ì˜ 2ë°° ë‘ê»˜ = ê½‰ ì°¬ ì› */
    }
    
    /* ì±„ì›Œì§€ëŠ” ì› (ìƒ‰ìƒ) */
    .fill-ring {
      fill: none; 
      stroke-width: 32; /* ê½‰ ì°¬ ì› */
      stroke-dasharray: 100 100; /* ë‘˜ë ˆ 100 ê¸°ì¤€ */
      stroke-dashoffset: 0; 
      transition: stroke-dashoffset 0.3s linear;
    }

    /* ë²„íŠ¼ ê·¸ë£¹ */
    .btn-group { display: flex; gap: 8px; width: 100%; margin-bottom: 20px; }
    .btn {
      flex: 1; padding: 10px; border-radius: 8px; border: none;
      font-size: 0.9rem; font-weight: 600; cursor: pointer;
    }
    .btn-main { color: white; }
    .btn-reset { background-color: white; border: 1px solid rgba(55, 53, 47, 0.15); color: #37352F; }

    /* ì„œëª… */
    .signature {
      font-size: 0.7rem; color: rgba(55, 53, 47, 0.3); font-family: sans-serif;
    }
  </style>
</head>
<body>

  <div class="container">
    
    <div id="selection-screen">
      <div class="menu-title">Select Mode</div>
      <button class="select-btn" onclick="app.start('pomodoro')">
        <span>ğŸ…</span> Pomodoro
      </button>
      <button class="select-btn" onclick="app.start('stopwatch')">
        <span>â±ï¸</span> Stopwatch
      </button>
      <div class="signature" style="margin-top: 20px;">nomadplanner</div>
    </div>

    <div id="timer-screen">
      <div class="timer-header">
        <button class="back-btn" onclick="app.back()">â† Back</button>
        <span class="mode-badge" id="badge">FOCUS</span>
      </div>

      <div class="timer-display" id="display">25:00</div>

      <div class="gauge-box">
        <svg class="progress-ring" viewBox="0 0 32 32">
          <circle class="bg-ring" r="8" cx="16" cy="16"></circle>
          <circle id="ring-fill" class="fill-ring" r="8" cx="16" cy="16"></circle>
        </svg>
      </div>

      <div class="btn-group">
        <button class="btn btn-main" id="btn-toggle" onclick="app.toggle()">Start</button>
        <button class="btn btn-reset" onclick="app.reset()">Reset</button>
      </div>

      <div class="signature">nomadplanner</div>
    </div>

  </div>

  <script>
    // === ì•ˆì „í•œ ì•± ê°ì²´ ìƒì„± ===
    var app = {
      mode: 'pomodoro',
      time: 1500, // 25ë¶„
      active: false,
      timerId: null,
      isFocus: true,
      
      // ìƒìˆ˜
      POMO_SEC: 1500, // 25 * 60
      BREAK_SEC: 300, // 5 * 60
      FULL_DASH: 50.3, // r=8ì¼ ë•Œ ë‘˜ë ˆ (2 * pi * 8)
      
      COLORS: {
        POMO: '#4A7C59', // ë…¹ìƒ‰
        BREAK: '#F28C28', // ì£¼í™©
        STOP: '#227C9D'  // íŒŒë‘
      },

      // 1. ëª¨ë“œ ì‹œì‘
      start: function(mode) {
        this.mode = mode;
        document.getElementById('selection-screen').style.display = 'none';
        document.getElementById('timer-screen').style.display = 'flex';
        this.reset();
      },

      // 2. ë’¤ë¡œ ê°€ê¸°
      back: function() {
        clearInterval(this.timerId);
        this.active = false;
        document.getElementById('timer-screen').style.display = 'none';
        document.getElementById('selection-screen').style.display = 'flex';
      },

      // 3. í† ê¸€ (Start/Pause)
      toggle: function() {
        if (this.active) {
          clearInterval(this.timerId);
          this.active = false;
        } else {
          this.timerId = setInterval(this.tick.bind(this), 1000);
          this.active = true;
        }
        this.update();
      },

      // 4. íƒ€ì´ë¨¸ ë¡œì§
      tick: function() {
        if (this.mode === 'pomodoro') {
          if (this.time > 0) {
            this.time--;
          } else {
            clearInterval(this.timerId);
            this.active = false;
            this.isFocus = !this.isFocus;
            this.time = this.isFocus ? this.POMO_SEC : this.BREAK_SEC;
            // ì•Œë¦¼ ê¸°ëŠ¥ (í•„ìš”ì‹œ ì£¼ì„ í•´ì œ)
            // alert("Time is up!");
          }
        } else {
          // ìŠ¤í†±ì›Œì¹˜
          this.time++;
        }
        this.update();
      },

      // 5. ë¦¬ì…‹
      reset: function() {
        clearInterval(this.timerId);
        this.active = false;
        this.isFocus = true;
        
        if (this.mode === 'pomodoro') {
          this.time = this.POMO_SEC;
        } else {
          this.time = 0;
        }
        this.update();
      },

      // 6. í™”ë©´ ì—…ë°ì´íŠ¸
      update: function() {
        // A. ì‹œê°„ í…ìŠ¤íŠ¸
        var m = Math.floor(this.time / 60);
        var s = this.time % 60;
        var txt = (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
        document.getElementById('display').innerText = txt;

        // B. ë²„íŠ¼ í…ìŠ¤íŠ¸
        var btn = document.getElementById('btn-toggle');
        btn.innerText = this.active ? "Pause" : "Start";

        // C. ê²Œì´ì§€ & ìƒ‰ìƒ
        var ring = document.getElementById('ring-fill');
        var badge = document.getElementById('badge');
        var color = this.COLORS.POMO;

        // íŒŒì´ ì°¨íŠ¸ ê³„ì‚° (r=8, stroke=32ë¡œ ê½‰ ì±„ìš´ ì›)
        // stroke-dasharrayë¥¼ ë‘˜ë ˆ(50.3)ë¡œ ì„¤ì •í•´ì•¼ í•¨
        ring.style.strokeDasharray = this.FULL_DASH + " " + this.FULL_DASH;

        if (this.mode === 'pomodoro') {
          var total = this.isFocus ? this.POMO_SEC : this.BREAK_SEC;
          var offset = this.FULL_DASH - (this.time / total) * this.FULL_DASH;
          ring.style.strokeDashoffset = offset;

          if (this.isFocus) {
            badge.innerText = "FOCUS";
            color = this.COLORS.POMO;
          } else {
            badge.innerText = "BREAK";
            color = this.COLORS.BREAK;
          }
        } else {
          // ìŠ¤í†±ì›Œì¹˜ (60ì´ˆë§ˆë‹¤ í•œ ë°”í€´)
          badge.innerText = "STOPWATCH";
          color = this.COLORS.STOP;
          var sec = this.time % 60;
          var offset = this.FULL_DASH - (sec / 60) * this.FULL_DASH;
          ring.style.strokeDashoffset = -offset; // ì°¨ì˜¤ë¥´ëŠ” ë°©í–¥
        }

        // ìƒ‰ìƒ ì ìš©
        ring.style.stroke = color;
        badge.style.color = color;
        badge.style.backgroundColor = color + "20"; // íˆ¬ëª…ë„ 20%
        
        if (this.active) {
          btn.style.backgroundColor = "#E0E0E0";
          btn.style.color = "#888";
        } else {
          btn.style.backgroundColor = color;
          btn.style.color = "white";
        }
      }
    };

    // ì´ˆê¸°í™” ì‹¤í–‰
    window.onload = function() {
      app.update();
    };
  </script>
</body>
</html>
